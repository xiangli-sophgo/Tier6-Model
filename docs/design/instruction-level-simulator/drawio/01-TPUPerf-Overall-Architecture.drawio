<mxfile host="app.diagrams.net" modified="2026-02-18" agent="Claude" version="24.7.17">
  <diagram id="tpuperf-overall" name="TPUPerf Overall Architecture">
    <mxGraphModel dx="1800" dy="1200" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="1200" math="0" shadow="0">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>

        <!-- ========== TITLE ========== -->
        <mxCell id="title" value="TPUPerf SystemC Simulation Architecture (SG2262 64-Core)" style="text;html=1;align=center;verticalAlign=middle;fontSize=20;fontStyle=1;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="400" y="20" width="800" height="40" as="geometry"/>
        </mxCell>
        <mxCell id="subtitle" value="Code: /code/TPUPerf/ | Language: C++ (SystemC 2.3.4) | Build: CMake" style="text;html=1;align=center;verticalAlign=middle;fontSize=11;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="400" y="55" width="800" height="25" as="geometry"/>
        </mxCell>

        <!-- ========== INPUT LAYER ========== -->
        <mxCell id="input_group" value="Input Layer" style="swimlane;html=1;startSize=28;fillColor=#f5f5f5;strokeColor=#666666;fontStyle=1;fontSize=12;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="40" y="100" width="1520" height="120" as="geometry"/>
        </mxCell>

        <mxCell id="bd_file" value=".BD Files&lt;br&gt;&lt;font style='font-size:9px;color:#666'&gt;TIU Binary Instructions&lt;br&gt;per core: .BD.0 ~ .BD.63&lt;/font&gt;" style="shape=document;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;fontStyle=1;" vertex="1" parent="input_group">
          <mxGeometry x="30" y="38" width="160" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="gdma_file" value=".GDMA Files&lt;br&gt;&lt;font style='font-size:9px;color:#666'&gt;DMA Binary Instructions&lt;br&gt;per core: .GDMA.0 ~ .GDMA.63&lt;/font&gt;" style="shape=document;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;fontStyle=1;" vertex="1" parent="input_group">
          <mxGeometry x="210" y="38" width="160" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="hau_file" value=".HAU Files&lt;br&gt;&lt;font style='font-size:9px;color:#666'&gt;HAU Instructions&lt;br&gt;(Optional)&lt;/font&gt;" style="shape=document;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=11;fontStyle=1;" vertex="1" parent="input_group">
          <mxGeometry x="390" y="38" width="140" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="sdma_file" value=".SDMA Files&lt;br&gt;&lt;font style='font-size:9px;color:#666'&gt;SDMA Instructions&lt;br&gt;(Optional)&lt;/font&gt;" style="shape=document;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=11;fontStyle=1;" vertex="1" parent="input_group">
          <mxGeometry x="550" y="38" width="140" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="json_cfg" value="JSON Config&lt;br&gt;&lt;font style='font-size:9px;color:#666'&gt;sg2262_template.json&lt;br&gt;Chip Arch Parameters&lt;/font&gt;" style="shape=document;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;fontStyle=1;" vertex="1" parent="input_group">
          <mxGeometry x="730" y="38" width="160" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="cli_args" value="CLI Arguments&lt;br&gt;&lt;font style='font-size:9px;color:#666'&gt;--tiuBuf --dmaBuf&lt;br&gt;--hauBuf --sdmaBuf&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;fontStyle=1;" vertex="1" parent="input_group">
          <mxGeometry x="910" y="38" width="150" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="compiler_note" value="&lt;font color='#999'&gt;Instructions generated by&lt;br&gt;TPU-MLIR Compiler&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;fontSize=10;fontStyle=2;" vertex="1" parent="input_group">
          <mxGeometry x="1100" y="48" width="150" height="50" as="geometry"/>
        </mxCell>

        <!-- ========== FRAMEWORK LAYER ========== -->
        <mxCell id="framework_group" value="Framework Layer (framework/)" style="swimlane;html=1;startSize=28;fillColor=#E6F3FF;strokeColor=#6c8ebf;fontStyle=1;fontSize=12;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="40" y="240" width="1520" height="110" as="geometry"/>
        </mxCell>

        <mxCell id="parser" value="Parser&lt;br&gt;&lt;font style='font-size:9px;color:#666'&gt;parser.h/cpp&lt;br&gt;Singleton, load_tiu_cmd()&lt;br&gt;load_gdma_cmd()&lt;br&gt;load_param()&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;fontStyle=1;" vertex="1" parent="framework_group">
          <mxGeometry x="30" y="35" width="180" height="68" as="geometry"/>
        </mxCell>

        <mxCell id="testbench" value="Testbench&lt;br&gt;&lt;font style='font-size:9px;color:#666'&gt;testbench.h/cpp&lt;br&gt;SystemC sc_module&lt;br&gt;Idle detection&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;fontStyle=1;" vertex="1" parent="framework_group">
          <mxGeometry x="230" y="35" width="160" height="68" as="geometry"/>
        </mxCell>

        <mxCell id="profiler" value="Profiler&lt;br&gt;&lt;font style='font-size:9px;color:#666'&gt;profiler.h&lt;br&gt;Brahma_profiler.h/cpp&lt;br&gt;CSV/RegInfo output&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;fontStyle=1;" vertex="1" parent="framework_group">
          <mxGeometry x="410" y="35" width="160" height="68" as="geometry"/>
        </mxCell>

        <mxCell id="instruction" value="Instruction&lt;br&gt;&lt;font style='font-size:9px;color:#666'&gt;instruction.h/cpp&lt;br&gt;Base command classes&lt;br&gt;Serialization&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;fontStyle=1;" vertex="1" parent="framework_group">
          <mxGeometry x="590" y="35" width="160" height="68" as="geometry"/>
        </mxCell>

        <mxCell id="utility" value="Utility&lt;br&gt;&lt;font style='font-size:9px;color:#666'&gt;utility.h / common.h&lt;br&gt;Address map, enums&lt;br&gt;Init, config&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;fontStyle=1;" vertex="1" parent="framework_group">
          <mxGeometry x="770" y="35" width="160" height="68" as="geometry"/>
        </mxCell>

        <mxCell id="xact_recorder" value="XactRecorder&lt;br&gt;&lt;font style='font-size:9px;color:#666'&gt;Transaction logger&lt;br&gt;AXI trace recording&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;fontStyle=1;" vertex="1" parent="framework_group">
          <mxGeometry x="950" y="35" width="150" height="68" as="geometry"/>
        </mxCell>

        <mxCell id="power_mapper" value="PowerMapper&lt;br&gt;&lt;font style='font-size:9px;color:#666'&gt;Power estimation&lt;br&gt;Voltage/freq ratio&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;fontStyle=1;" vertex="1" parent="framework_group">
          <mxGeometry x="1120" y="35" width="150" height="68" as="geometry"/>
        </mxCell>

        <!-- ========== SPEC LAYER ========== -->
        <mxCell id="spec_group" value="Chip Spec Layer (spec/)" style="swimlane;html=1;startSize=28;fillColor=#FFF5E6;strokeColor=#d6b656;fontStyle=1;fontSize=12;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="40" y="370" width="1520" height="100" as="geometry"/>
        </mxCell>

        <mxCell id="spec_sg2262" value="spec/sg2262/&lt;br&gt;&lt;font style='font-size:9px;color:#666'&gt;mm2_cmd, conv_cmd&lt;br&gt;sfu_cmd, ar_cmd ...&lt;br&gt;19 instruction types&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;fontStyle=1;" vertex="1" parent="spec_group">
          <mxGeometry x="30" y="33" width="160" height="60" as="geometry"/>
        </mxCell>

        <mxCell id="spec_sg2260" value="spec/sg2260/&lt;br&gt;&lt;font style='font-size:9px;color:#666'&gt;8-core variant&lt;br&gt;+ CDMA reg parse&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;fontStyle=1;" vertex="1" parent="spec_group">
          <mxGeometry x="210" y="33" width="150" height="60" as="geometry"/>
        </mxCell>

        <mxCell id="spec_bm1684x" value="spec/bm1684x/&lt;br&gt;&lt;font style='font-size:9px;color:#666'&gt;bd_reg_def.h&lt;br&gt;gdma_reg_def.h&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;fontStyle=1;" vertex="1" parent="spec_group">
          <mxGeometry x="380" y="33" width="150" height="60" as="geometry"/>
        </mxCell>

        <mxCell id="spec_others" value="spec/mars3, bm1688&lt;br&gt;bm1684x2, base/&lt;br&gt;&lt;font style='font-size:9px;color:#666'&gt;Other chip architectures&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;fontStyle=1;" vertex="1" parent="spec_group">
          <mxGeometry x="550" y="33" width="170" height="60" as="geometry"/>
        </mxCell>

        <mxCell id="spec_note" value="&lt;font color='#999'&gt;Each chip spec defines:&lt;br&gt;- Register bit-field definitions&lt;br&gt;- Command classes (store/load binary)&lt;br&gt;- Instruction format (short/long)&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;fontSize=10;fontStyle=2;" vertex="1" parent="spec_group">
          <mxGeometry x="780" y="33" width="250" height="60" as="geometry"/>
        </mxCell>

        <!-- ========== CORE SIMULATION ENGINE (c_model/) ========== -->
        <mxCell id="cmodel_group" value="Core Simulation Engine (c_model/) - SystemC Modules" style="swimlane;html=1;startSize=30;fillColor=#F0FFF0;strokeColor=#82b366;fontStyle=1;fontSize=13;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="40" y="490" width="1520" height="420" as="geometry"/>
        </mxCell>

        <!-- TPU Compute -->
        <mxCell id="tpu_label" value="TPU Compute (c_model/tpu/)" style="text;html=1;align=left;verticalAlign=middle;fontSize=11;fontStyle=1;fontColor=#2D7600;" vertex="1" parent="cmodel_group">
          <mxGeometry x="20" y="35" width="200" height="20" as="geometry"/>
        </mxCell>

        <mxCell id="tiu_module" value="&lt;b&gt;TIU&lt;/b&gt;&lt;br&gt;&lt;font style='font-size:9px;color:#555'&gt;tiu.h/cc&lt;br&gt;Tensor Instruction Unit&lt;br&gt;State: Init-&gt;Compute-&gt;Finish&lt;br&gt;cmd_id/cmd_id_dep sync&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;" vertex="1" parent="cmodel_group">
          <mxGeometry x="20" y="60" width="170" height="85" as="geometry"/>
        </mxCell>

        <mxCell id="tiu_eng" value="&lt;b&gt;TIU Engine&lt;/b&gt;&lt;br&gt;&lt;font style='font-size:9px;color:#555'&gt;tiu_eng.h/cc&lt;br&gt;Cycle calculation&lt;br&gt;cal_cycle() per instr type&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;" vertex="1" parent="cmodel_group">
          <mxGeometry x="200" y="60" width="160" height="85" as="geometry"/>
        </mxCell>

        <mxCell id="bank_conflict" value="&lt;b&gt;BankConflictChecker&lt;/b&gt;&lt;br&gt;&lt;font style='font-size:9px;color:#555'&gt;bank_conflict_checker.h/cpp&lt;br&gt;LMEM bank walk path&lt;br&gt;Conflict cycle overhead&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;" vertex="1" parent="cmodel_group">
          <mxGeometry x="370" y="60" width="175" height="85" as="geometry"/>
        </mxCell>

        <mxCell id="hau_module" value="&lt;b&gt;HAU&lt;/b&gt;&lt;br&gt;&lt;font style='font-size:9px;color:#555'&gt;hau.h/cc&lt;br&gt;Hash Accel Unit&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;" vertex="1" parent="cmodel_group">
          <mxGeometry x="555" y="60" width="120" height="85" as="geometry"/>
        </mxCell>

        <!-- DMA -->
        <mxCell id="dma_label" value="DMA Engines (c_model/sg2260/ + bm1684x/)" style="text;html=1;align=left;verticalAlign=middle;fontSize=11;fontStyle=1;fontColor=#2D7600;" vertex="1" parent="cmodel_group">
          <mxGeometry x="20" y="155" width="350" height="20" as="geometry"/>
        </mxCell>

        <mxCell id="tdma_module" value="&lt;b&gt;TDMA (GDMA)&lt;/b&gt;&lt;br&gt;&lt;font style='font-size:9px;color:#555'&gt;tdma.h/cc&lt;br&gt;General DMA engine&lt;br&gt;rd/wr segmentation threads&lt;br&gt;cmd_collect, outstanding ctrl&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;" vertex="1" parent="cmodel_group">
          <mxGeometry x="20" y="180" width="180" height="85" as="geometry"/>
        </mxCell>

        <mxCell id="tdma2bus" value="&lt;b&gt;TDMA2Bus&lt;/b&gt;&lt;br&gt;&lt;font style='font-size:9px;color:#555'&gt;tdma2bus.h/cc&lt;br&gt;DMA-to-bus bridge&lt;br&gt;Address translation&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;" vertex="1" parent="cmodel_group">
          <mxGeometry x="210" y="180" width="155" height="85" as="geometry"/>
        </mxCell>

        <mxCell id="lmem_agent" value="&lt;b&gt;LmemAgent&lt;/b&gt;&lt;br&gt;&lt;font style='font-size:9px;color:#555'&gt;lmem_agent.h/cpp&lt;br&gt;LMEM TLM interface&lt;br&gt;128B bus, burst=4&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;" vertex="1" parent="cmodel_group">
          <mxGeometry x="375" y="180" width="155" height="85" as="geometry"/>
        </mxCell>

        <mxCell id="gmem_agent" value="&lt;b&gt;GmemAgent&lt;/b&gt;&lt;br&gt;&lt;font style='font-size:9px;color:#555'&gt;gmem_agent.h/cpp&lt;br&gt;DDR TLM interface&lt;br&gt;Dynamic outstanding&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;" vertex="1" parent="cmodel_group">
          <mxGeometry x="540" y="180" width="155" height="85" as="geometry"/>
        </mxCell>

        <!-- Memory -->
        <mxCell id="mem_label" value="Memory Subsystem (c_model/memory/)" style="text;html=1;align=left;verticalAlign=middle;fontSize=11;fontStyle=1;fontColor=#2D7600;" vertex="1" parent="cmodel_group">
          <mxGeometry x="720" y="35" width="280" height="20" as="geometry"/>
        </mxCell>

        <mxCell id="lmem_module" value="&lt;b&gt;LMEM&lt;/b&gt;&lt;br&gt;&lt;font style='font-size:9px;color:#555'&gt;lmem.h/cpp&lt;br&gt;2MB, 16 banks/core&lt;br&gt;29ns latency&lt;br&gt;Bank conflict detection&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;" vertex="1" parent="cmodel_group">
          <mxGeometry x="720" y="60" width="155" height="85" as="geometry"/>
        </mxCell>

        <mxCell id="ddr_module" value="&lt;b&gt;DdrWrapper&lt;/b&gt;&lt;br&gt;&lt;font style='font-size:9px;color:#555'&gt;ddr_wrapper.h/cpp&lt;br&gt;150ns latency&lt;br&gt;Bank group/row conflict&lt;br&gt;Outstanding FIFO (128)&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;" vertex="1" parent="cmodel_group">
          <mxGeometry x="885" y="60" width="170" height="85" as="geometry"/>
        </mxCell>

        <mxCell id="gs_cache" value="&lt;b&gt;GsCache&lt;/b&gt;&lt;br&gt;&lt;font style='font-size:9px;color:#555'&gt;gs_cache.h/cpp&lt;br&gt;4-way set assoc&lt;br&gt;128B line, LRU&lt;br&gt;Miss merging&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;" vertex="1" parent="cmodel_group">
          <mxGeometry x="1065" y="60" width="145" height="85" as="geometry"/>
        </mxCell>

        <mxCell id="are_module" value="&lt;b&gt;ARE&lt;/b&gt;&lt;br&gt;&lt;font style='font-size:9px;color:#555'&gt;are.h/cpp&lt;br&gt;Address Routing Engine&lt;br&gt;DDR address mapping&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;" vertex="1" parent="cmodel_group">
          <mxGeometry x="1220" y="60" width="145" height="85" as="geometry"/>
        </mxCell>

        <mxCell id="sam_module" value="&lt;b&gt;SAM&lt;/b&gt;&lt;br&gt;&lt;font style='font-size:9px;color:#555'&gt;system_address_map.h/cpp&lt;br&gt;LMEM/DDR/L2 ranges&lt;br&gt;Per-chip mapping&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;" vertex="1" parent="cmodel_group">
          <mxGeometry x="1375" y="60" width="135" height="85" as="geometry"/>
        </mxCell>

        <!-- Fabric / Interconnect -->
        <mxCell id="fabric_label" value="Interconnect (c_model/fabric/ + scheme/)" style="text;html=1;align=left;verticalAlign=middle;fontSize=11;fontStyle=1;fontColor=#2D7600;" vertex="1" parent="cmodel_group">
          <mxGeometry x="720" y="155" width="300" height="20" as="geometry"/>
        </mxCell>

        <mxCell id="simple_bus" value="&lt;b&gt;SimpleBus&lt;128,64&gt;&lt;/b&gt;&lt;br&gt;&lt;font style='font-size:9px;color:#555'&gt;simple_bus.h&lt;br&gt;128 master (64 GDMA + 64 SDMA)&lt;br&gt;64 slave (64 DDR)&lt;br&gt;TLM-2.0 transport&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;" vertex="1" parent="cmodel_group">
          <mxGeometry x="720" y="180" width="200" height="85" as="geometry"/>
        </mxCell>

        <mxCell id="bus_scheme" value="&lt;b&gt;SimpleBusScheme&lt;/b&gt;&lt;br&gt;&lt;font style='font-size:9px;color:#555'&gt;simple_bus_scheme.h&lt;br&gt;Latency matrix config&lt;br&gt;Manhattan distance model&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;" vertex="1" parent="cmodel_group">
          <mxGeometry x="930" y="180" width="170" height="85" as="geometry"/>
        </mxCell>

        <mxCell id="crossbar" value="&lt;b&gt;CrossBar&lt;/b&gt;&lt;br&gt;&lt;font style='font-size:9px;color:#555'&gt;crossBar.h&lt;br&gt;Alternative fabric&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;dashed=1;" vertex="1" parent="cmodel_group">
          <mxGeometry x="1110" y="180" width="130" height="85" as="geometry"/>
        </mxCell>

        <!-- Multi-chip -->
        <mxCell id="multichip_label" value="Multi-Chip (c_model/sg2260/)" style="text;html=1;align=left;verticalAlign=middle;fontSize=11;fontStyle=1;fontColor=#2D7600;" vertex="1" parent="cmodel_group">
          <mxGeometry x="20" y="275" width="250" height="20" as="geometry"/>
        </mxCell>

        <mxCell id="cdma_module" value="&lt;b&gt;CDMA&lt;/b&gt;&lt;br&gt;&lt;font style='font-size:9px;color:#555'&gt;cdma.h/cc&lt;br&gt;Cross-chip DMA&lt;br&gt;SEND/RECV/ALLREDUCE&lt;br&gt;Credit flow control&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;" vertex="1" parent="cmodel_group">
          <mxGeometry x="20" y="300" width="170" height="85" as="geometry"/>
        </mxCell>

        <mxCell id="c2c_module" value="&lt;b&gt;C2C&lt;/b&gt;&lt;br&gt;&lt;font style='font-size:9px;color:#555'&gt;c2c.h/cc&lt;br&gt;Chip-to-Chip link&lt;br&gt;11.2 GB/s BW&lt;br&gt;ROB ordered submit&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;" vertex="1" parent="cmodel_group">
          <mxGeometry x="200" y="300" width="160" height="85" as="geometry"/>
        </mxCell>

        <mxCell id="fakechip" value="&lt;b&gt;FakeChip&lt;/b&gt;&lt;br&gt;&lt;font style='font-size:9px;color:#555'&gt;fakechip.h/cc&lt;br&gt;Remote chip stub&lt;br&gt;Pseudo-delay model&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;" vertex="1" parent="cmodel_group">
          <mxGeometry x="370" y="300" width="150" height="85" as="geometry"/>
        </mxCell>

        <!-- IFE -->
        <mxCell id="ife_label" value="Instruction Fetch (ip/ife/)" style="text;html=1;align=left;verticalAlign=middle;fontSize=11;fontStyle=1;fontColor=#2D7600;" vertex="1" parent="cmodel_group">
          <mxGeometry x="560" y="275" width="200" height="20" as="geometry"/>
        </mxCell>

        <mxCell id="ife_module" value="&lt;b&gt;IFE&lt;/b&gt;&lt;br&gt;&lt;font style='font-size:9px;color:#555'&gt;ife.h/cpp&lt;br&gt;Instruction Fetch Engine&lt;br&gt;Decode + dispatch&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;" vertex="1" parent="cmodel_group">
          <mxGeometry x="560" y="300" width="155" height="85" as="geometry"/>
        </mxCell>

        <mxCell id="ife_master" value="&lt;b&gt;IFE Master&lt;/b&gt;&lt;br&gt;&lt;font style='font-size:9px;color:#555'&gt;ife_master.h/cpp&lt;br&gt;Master controller&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;" vertex="1" parent="cmodel_group">
          <mxGeometry x="725" y="300" width="140" height="85" as="geometry"/>
        </mxCell>

        <!-- Top level -->
        <mxCell id="top_label" value="Top-Level Assembly (c_model/top/)" style="text;html=1;align=left;verticalAlign=middle;fontSize=11;fontStyle=1;fontColor=#2D7600;" vertex="1" parent="cmodel_group">
          <mxGeometry x="900" y="275" width="250" height="20" as="geometry"/>
        </mxCell>

        <mxCell id="sg2262_top" value="&lt;b&gt;sg2262_top.cpp&lt;/b&gt;&lt;br&gt;&lt;font style='font-size:9px;color:#555'&gt;sc_main() entry point&lt;br&gt;64x TpuSubsys + 64x DDR&lt;br&gt;+ SimpleBus + CDMA/C2C&lt;br&gt;6 clock domains&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#60a917;strokeColor=#2D7600;fontColor=#ffffff;fontSize=11;" vertex="1" parent="cmodel_group">
          <mxGeometry x="900" y="300" width="200" height="85" as="geometry"/>
        </mxCell>

        <mxCell id="tpu_subsys" value="&lt;b&gt;TpuSubsys&lt;/b&gt;&lt;br&gt;&lt;font style='font-size:9px;color:#555'&gt;tpu_subsys.h/cc&lt;br&gt;Per-core container&lt;br&gt;TIU+GDMA+SDMA+HAU+LMEM&lt;br&gt;sync_id signals&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#60a917;strokeColor=#2D7600;fontColor=#ffffff;fontSize=11;" vertex="1" parent="cmodel_group">
          <mxGeometry x="1110" y="300" width="185" height="85" as="geometry"/>
        </mxCell>

        <!-- ========== IP LAYER ========== -->
        <mxCell id="ip_group" value="IP Blocks (ip/) - Hardware Block Models" style="swimlane;html=1;startSize=28;fillColor=#FFF0F0;strokeColor=#b85450;fontStyle=1;fontSize=12;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="40" y="930" width="750" height="110" as="geometry"/>
        </mxCell>

        <mxCell id="tiu_dpc" value="&lt;b&gt;TIU Module (ip/tiu_module/)&lt;/b&gt;&lt;br&gt;&lt;font style='font-size:9px;color:#555'&gt;dpc_gen / dpc_arb / dpc_issue / compute_unit&lt;br&gt;Each instr type has gen+issue specialization&lt;br&gt;conv, mm2, sfu, ar, cmp, sg, lin, vc, rqdq ...&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=11;" vertex="1" parent="ip_group">
          <mxGeometry x="20" y="35" width="340" height="65" as="geometry"/>
        </mxCell>

        <mxCell id="wdc_modules" value="&lt;b&gt;WDC (ip/wdc/)&lt;/b&gt;&lt;br&gt;&lt;font style='font-size:9px;color:#555'&gt;aux_are, aux_cam, aux_fab&lt;br&gt;cam_table, x2x bridge&lt;br&gt;Memory controller helpers&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=11;" vertex="1" parent="ip_group">
          <mxGeometry x="380" y="35" width="180" height="65" as="geometry"/>
        </mxCell>

        <mxCell id="move_module" value="&lt;b&gt;Move Module&lt;/b&gt;&lt;br&gt;&lt;font style='font-size:9px;color:#555'&gt;ip/ife/move_module&lt;br&gt;DMA descriptor parse&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=11;" vertex="1" parent="ip_group">
          <mxGeometry x="575" y="35" width="155" height="65" as="geometry"/>
        </mxCell>

        <!-- ========== OUTPUT LAYER ========== -->
        <mxCell id="output_group" value="Output &amp; Analysis" style="swimlane;html=1;startSize=28;fillColor=#F5F0FF;strokeColor=#9673a6;fontStyle=1;fontSize=12;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="810" y="930" width="750" height="110" as="geometry"/>
        </mxCell>

        <mxCell id="csv_output" value="&lt;b&gt;CSV / RegInfo&lt;/b&gt;&lt;br&gt;&lt;font style='font-size:9px;color:#555'&gt;tiuRegInfo*.txt&lt;br&gt;tdmaRegInfo*.txt&lt;br&gt;Per-cmd cycle data&lt;/font&gt;" style="shape=document;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=11;" vertex="1" parent="output_group">
          <mxGeometry x="20" y="35" width="150" height="65" as="geometry"/>
        </mxCell>

        <mxCell id="perfai" value="&lt;b&gt;PerfAI (Python)&lt;/b&gt;&lt;br&gt;&lt;font style='font-size:9px;color:#555'&gt;PerfAI/PerfAI.doc/&lt;br&gt;run_doc.py&lt;br&gt;Excel + layer analysis&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=11;fontStyle=1;" vertex="1" parent="output_group">
          <mxGeometry x="190" y="35" width="155" height="65" as="geometry"/>
        </mxCell>

        <mxCell id="perfweb" value="&lt;b&gt;PerfWeb&lt;/b&gt;&lt;br&gt;&lt;font style='font-size:9px;color:#555'&gt;PerfWeb/&lt;br&gt;result.html + echarts&lt;br&gt;Web visualization&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=11;fontStyle=1;" vertex="1" parent="output_group">
          <mxGeometry x="365" y="35" width="155" height="65" as="geometry"/>
        </mxCell>

        <mxCell id="total_cycle" value="&lt;b&gt;simTotalCycle&lt;/b&gt;&lt;br&gt;&lt;font style='font-size:9px;color:#555'&gt;Total cycle count&lt;br&gt;Per-core summary&lt;/font&gt;" style="shape=document;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=11;" vertex="1" parent="output_group">
          <mxGeometry x="540" y="35" width="140" height="65" as="geometry"/>
        </mxCell>

        <!-- ========== NoC (separate) ========== -->
        <mxCell id="noc_group" value="NoC Module (noc/) - Optional" style="swimlane;html=1;startSize=25;fillColor=#f5f5f5;strokeColor=#999999;fontStyle=1;fontSize=11;rounded=1;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="40" y="1060" width="1520" height="75" as="geometry"/>
        </mxCell>

        <mxCell id="noc_desc" value="&lt;font color='#999'&gt;Router / Buffer / Tile / MM / ProcessingElement / GlobalRoutingTable / ReservationTable / link_slice | Flit-level NoC simulation, NOT used in SG2262 default (uses SimpleBus instead)&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;fontSize=10;fontStyle=2;" vertex="1" parent="noc_group">
          <mxGeometry x="20" y="30" width="1200" height="35" as="geometry"/>
        </mxCell>

        <!-- ========== KEY CONNECTIONS ========== -->
        <!-- Input -> Framework -->
        <mxCell id="conn1" style="edgeStyle=orthogonalEdgeStyle;rounded=1;html=1;strokeColor=#6c8ebf;strokeWidth=2;entryX=0.5;entryY=0;entryDx=0;entryDy=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="bd_file" target="parser">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- Framework -> Spec -->
        <mxCell id="conn2" style="edgeStyle=orthogonalEdgeStyle;rounded=1;html=1;strokeColor=#d6b656;strokeWidth=1.5;dashed=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="parser" target="spec_sg2262">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
